<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Casino — Mini Juegos (Pro, 2 filas tipo Stake)</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
<style>
  /* ================== Variables y base ================== */
  :root{
    --bg:#0f1724;
    --card:#0b1220;
    --glass: rgba(255,255,255,0.04);
    --glass-2: rgba(255,255,255,0.03);
    --glass-border: rgba(255,255,255,0.06);
    --muted: rgba(255,255,255,0.65);
    --accent1-start:#7c3aed;
    --accent1-end:#06b6d4;
    --accent-glow: rgba(124,58,237,0.22);
    --card-radius:16px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background:
      radial-gradient(800px 400px at 10% 10%, rgba(124,58,237,0.06), transparent 10%),
      radial-gradient(700px 350px at 90% 80%, rgba(6,182,212,0.04), transparent 10%),
      var(--bg);
    color:#e6eef8;
    -webkit-font-smoothing:antialiased;
    padding:28px;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }
  .container{max-width:1200px;margin:0 auto}
  header{display:flex;align-items:center;justify-content:space-between;margin-bottom:34px;gap:20px}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,#071025,#0b1220);display:grid;place-items:center;border:1px solid rgba(255,255,255,0.03)}
  h1{font-size:18px;margin:0}
  p.sub{margin:0;color:var(--muted);font-size:13px}
  .balance{background:var(--glass);padding:10px 14px;border-radius:999px;border:1px solid var(--glass-border);display:flex;gap:10px;align-items:center}
  .balance .dot{width:12px;height:12px;border-radius:50%;background:linear-gradient(90deg,#34d399,#10b981);box-shadow:0 6px 18px rgba(16,185,129,0.12)}

  /* ================== Hero ================== */
  .hero{display:flex;align-items:center;justify-content:space-between;gap:20px;margin-bottom:28px;flex-wrap:wrap}
  .hero-left{flex:1;min-width:260px}
  .hero-right{width:300px;min-width:260px}
  .title{font-size:28px;font-weight:800;margin:0 0 6px}
  .subtitle{color:var(--muted);margin:0 0 18px}

  /* ================== Grid de juegos (compacta, 2 filas tipo Stake) ================== */
  .games-wrap{max-width:860px;margin:0 auto;} /* Limita el ancho para 2 columnas en desktop */
  .games-grid{
    display:grid;
    grid-template-columns:repeat(2, minmax(180px,1fr)); /* Fuerza 2 columnas en escritorio */
    gap:18px; /* un poco menos separadas para look compacto */
    align-items:start;
  }
  /* En mobile, 1 columna */
  @media (max-width:640px){
    .games-grid{grid-template-columns:1fr}
  }

  .card-game{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:var(--card-radius);
    padding:14px; /* antes 18px */
    border:1px solid var(--glass-border);
    box-shadow:0 10px 30px rgba(2,6,23,0.6);
    transition:transform .28s cubic-bezier(.2,.9,.2,1), box-shadow .28s ease, background .28s ease;
    display:flex;flex-direction:column;gap:8px; /* antes 12px */
    overflow:hidden;
  }
  .card-game:hover{transform:translateY(-8px);box-shadow:0 30px 80px rgba(2,6,23,0.85);background:rgba(255,255,255,0.035)}

  /* imagen compacta */
  .hero-img, .game-img{
    width:100%;
    height:120px; /* antes 160px */
    border-radius:12px;
    background:linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.02);
    display:grid;place-items:center;
    position:relative;overflow:hidden;
  }
  .game-img svg{width:70%;height:70%;opacity:0.95}

  .tag{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03);font-size:12px;color:var(--muted)}

  .meta{display:flex;justify-content:space-between;align-items:center;gap:10px}
  .desc{color:var(--muted);font-size:13px;line-height:1.35} /* antes 14px */

  .controls{display:flex;gap:8px;margin-top:auto;align-items:center}
  .btn{padding:9px 12px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent1-start),var(--accent1-end));color:white;font-weight:700;cursor:pointer;box-shadow:0 8px 30px rgba(124,58,237,0.14);transition:transform .18s ease,opacity .18s ease;width:100%}
  .btn:hover{transform:translateY(-3px);opacity:0.98}
  .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);box-shadow:none;width:auto;padding:8px 12px}

  /* títulos compactos */
  .card-game h3{font-size:15px;margin:2px 0 0} /* antes 16/17px aprox */

  /* big badge */
  .ribbon{position:absolute;left:12px;top:12px;padding:8px 12px;border-radius:999px;background:linear-gradient(90deg,#ffd166,#ef4444);color:#071026;font-weight:800;font-size:13px;box-shadow:0 6px 20px rgba(239,68,68,0.12)}

  /* hover glow effect */
  .card-game::after{
    content:'';
    position:absolute;inset:0;pointer-events:none;border-radius:var(--card-radius);box-shadow:0 0 40px 6px transparent;transition:box-shadow .28s ease;
    z-index:0;
  }
  .card-game:hover::after{box-shadow:0 0 60px 12px var(--accent-glow)}

  /* ================== Layout adicional, filtros y modal ================== */
  .toolbar{display:flex;gap:12px;align-items:center;margin-bottom:18px;flex-wrap:wrap}
  .search{background:var(--glass);padding:8px 12px;border-radius:999px;border:1px solid var(--glass-border);min-width:220px;color:inherit}
  .filters{display:flex;gap:8px}
  .chip{padding:8px 12px;border-radius:999px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.02);font-size:13px;color:var(--muted);cursor:pointer}
  .chip.active{background:linear-gradient(90deg,var(--accent1-start),var(--accent1-end));color:white;border:none;box-shadow:0 10px 30px rgba(124,58,237,0.12)}

  .modal{position:fixed;inset:0;display:grid;place-items:center;background:linear-gradient(180deg, rgba(2,6,23,0.6), rgba(2,6,23,0.85));z-index:140;opacity:0;visibility:hidden;transition:opacity .18s, visibility .18s}
  .modal.open{opacity:1;visibility:visible}
  .modal-card{background:linear-gradient(180deg,#0b1220,#071026);padding:20px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);width:720px;box-shadow:0 30px 80px rgba(2,6,23,0.7)}
  .modal-card h3{margin:0 0 8px}
  .modal-body{color:var(--muted);font-size:14px;line-height:1.5}

  /* responsive ajustes finos */
  @media (max-width:980px){
    .hero-right{width:100%;min-width:0}
    .hero{flex-direction:column;align-items:flex-start}
  }
  @media (max-width:560px){
    body{padding:18px}
  }
</style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none"><path d="M12 3L21 9L16 21H8L3 9L12 3Z" stroke="url(#g1)" stroke-width="1.2" stroke-linejoin="round"/><defs><linearGradient id="g1" x1="0" x2="1"><stop offset="0" stop-color="#7c3aed"/><stop offset="1" stop-color="#06b6d4"/></linearGradient></defs></svg>
        </div>
        <div>
          <h1>Casino</h1>
          <p class="sub">Mini Juegos — Plataforma estilo moderno</p>
        </div>
      </div>

      <div class="balance" title="Balance demo">
        <div class="dot" aria-hidden="true"></div>
        <div style="font-weight:800">0.524 BTC</div>
        <div style="font-size:12px;color:var(--muted)">Balance</div>
      </div>
    </header>

    <section class="hero">
      <div class="hero-left">
        <div class="title">Mini Juegos</div>
        <div class="subtitle">Seleccioná un mini juego y divertite. Diseño coherente con Mines — mismas fuentes, colores y comportamientos.</div>

        <div class="toolbar" style="margin-top:18px">
          <input class="search" id="searchInput" placeholder="Buscar juegos..." />
          <div class="filters" role="tablist" aria-label="Filtros">
            <div class="chip active" data-filter="all">Todos</div>
            <div class="chip" data-filter="hot">Hot</div>
            <div class="chip" data-filter="new">Nuevos</div>
            <div class="chip" data-filter="cards">Cartas</div>
          </div>
        </div>
      </div>

      <div class="hero-right">
        <div class="hero-img" aria-hidden="true">
          <!-- placeholder SVG grande para peso y estética -->
          <svg viewBox="0 0 600 300" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
            <defs>
              <linearGradient id="hg1" x1="0" x2="1"><stop offset="0" stop-color="#7c3aed"/><stop offset="1" stop-color="#06b6d4"/></linearGradient>
              <filter id="f1" x="-20%" y="-20%" width="140%" height="140%"><feGaussianBlur stdDeviation="18" result="b"/><feBlend in="SourceGraphic" in2="b"/></filter>
            </defs>
            <rect x="0" y="0" width="600" height="300" rx="18" fill="url(#hg1)" opacity="0.06"></rect>
            <g filter="url(#f1)">
              <circle cx="120" cy="80" r="50" fill="#7c3aed" opacity="0.12"/>
              <circle cx="300" cy="40" r="30" fill="#06b6d4" opacity="0.12"/>
              <circle cx="420" cy="140" r="70" fill="#7c3aed" opacity="0.08"/>
            </g>
            <g transform="translate(60,40)">
              <text x="0" y="120" font-size="42" fill="#e6eef8" font-weight="800" font-family="Inter, sans-serif">CASINO</text>
            </g>
          </svg>
        </div>
      </div>
    </section>

    <section aria-labelledby="gamesTitle" style="margin-top:8px">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px" class="games-wrap">
        <div>
          <div class="tag">Destacados</div>
        </div>
        <div style="color:var(--muted);font-size:13px">4 juegos — estilo unificado</div>
      </div>

      <div class="games-wrap">
        <div class="games-grid" id="gamesGrid">
          <!-- Card 1 -->
          <article class="card-game" data-tags="hot,cards">
            <div style="position:relative">
              <div class="ribbon">TOP</div>
              <div class="game-img" role="img" aria-label="MATEOIMG1.jpg">
                <!-- Placeholder visual: ruta MATEOIMG1 -->
                <svg viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
                  <rect width="200" height="120" rx="10" fill="url(#g1)" opacity="0.06"/>
                  <defs><linearGradient id="g1" x1="0" x2="1"><stop offset="0" stop-color="#7c3aed"/><stop offset="1" stop-color="#06b6d4"/></linearGradient></defs>
                  <g transform="translate(12,18)" fill="#e6eef8" opacity="0.95"><text x="0" y="40" font-size="24" font-weight="800" font-family="Inter, sans-serif">MATEOIMG1</text></g>
                </svg>
              </div>
            </div>
            <h3>Mini Juego 1 — Mines style</h3>
            <div class="meta"><div class="tag">Mines</div><div style="color:var(--muted);font-size:13px">5x5 — Riesgo medio</div></div>
            <p class="desc">Experimentá el clásico juego de minas con tablero 5x5. Lógica coherente con la versión principal: seleccionar minas, descubrir casillas y cobrar antes de explotar.</p>
            <div class="controls">
              <button class="btn" data-href="MATEO1">Jugar</button>
              <button class="btn secondary" data-action="info" data-title="Mini Juego 1" data-desc="Versión demo con tablero 5x5 y cashout.">Info</button>
            </div>
          </article>

          <!-- Card 2 -->
          <article class="card-game" data-tags="new">
            <div style="position:relative">
              <div class="game-img" role="img" aria-label="MATEOIMG2">
                <svg viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
                  <rect width="200" height="120" rx="10" fill="url(#g2)" opacity="0.06"/>
                  <defs><linearGradient id="g2" x1="0" x2="1"><stop offset="0" stop-color="#06b6d4"/><stop offset="1" stop-color="#7c3aed"/></linearGradient></defs>
                  <g transform="translate(16,24)" fill="#e6eef8" opacity="0.95"><text x="0" y="40" font-size="24" font-weight="800" font-family="Inter, sans-serif">MATEOIMG2</text></g>
                </svg>
              </div>
            </div>
            <h3>Mini Juego 2 — Crash</h3>
            <div class="meta"><div class="tag">Crash</div><div style="color:var(--muted);font-size:13px">Rápido — Alta volatilidad</div></div>
            <p class="desc">Simula una ronda de Crash: sube el multiplicador y retirá a tiempo para ganar. Ideal para partidas rápidas y apuestas dinámicas.</p>
            <div class="controls">
              <button class="btn" data-href="MATEO2">Jugar</button>
              <button class="btn secondary" data-action="info" data-title="Mini Juego 2" data-desc="Rondas rápidas con multiplicador creciente.">Info</button>
            </div>
          </article>

          <!-- Card 3 -->
          <article class="card-game" data-tags="cards,hot">
            <div style="position:relative">
              <div class="game-img" role="img" aria-label="MATEOIMG3">
                <svg viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
                  <rect width="200" height="120" rx="10" fill="url(#g3)" opacity="0.06"/>
                  <defs><linearGradient id="g3" x1="0" x2="1"><stop offset="0" stop-color="#7c3aed"/><stop offset="1" stop-color="#06b6d4"/></linearGradient></defs>
                  <g transform="translate(16,28)" fill="#e6eef8" opacity="0.95"><text x="0" y="40" font-size="24" font-weight="800" font-family="Inter, sans-serif">MATEOIMG3</text></g>
                </svg>
              </div>
            </div>
            <h3>Mini Juego 3 — Plinko</h3>
            <div class="meta"><div class="tag">Plinko</div><div style="color:var(--muted);font-size:13px">Casual — Gráficos</div></div>
            <p class="desc">Dejá caer la ficha y observá dónde caíga — un clásico divertido. Cuanto más baja la casilla, mayor el premio.</p>
            <div class="controls">
              <button class="btn" data-href="MATEO3">Jugar</button>
              <button class="btn secondary" data-action="info" data-title="Mini Juego 3" data-desc="Plinko clásico con tabla de premios.">Info</button>
            </div>
          </article>

          <!-- Card 4 -->
          <article class="card-game" data-tags="cards">
            <div style="position:relative">
              <div class="game-img" role="img" aria-label="MATEOIMG4">
                <svg viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
                  <rect width="200" height="120" rx="10" fill="url(#g4)" opacity="0.06"/>
                  <defs><linearGradient id="g4" x1="0" x2="1"><stop offset="0" stop-color="#06b6d4"/><stop offset="1" stop-color="#7c3aed"/></linearGradient></defs>
                  <g transform="translate(16,28)" fill="#e6eef8" opacity="0.95"><text x="0" y="40" font-size="24" font-weight="800" font-family="Inter, sans-serif">MATEOIMG4</text></g>
                </svg>
              </div>
            </div>
            <h3>Mini Juego 4 — Torre</h3>
            <div class="meta"><div class="tag">Torre</div><div style="color:var(--muted);font-size:13px">Estrategia</div></div>
            <p class="desc">Subí por la torre seleccionando niveles seguros. Cada nivel multiplica tu apuesta.</p>
            <div class="controls">
              <button class="btn" data-href="MATEO4">Jugar</button>
              <button class="btn secondary" data-action="info" data-title="Mini Juego 4" data-desc="Torre escalable con apuestas progresivas.">Info</button>
            </div>
          </article>
        </div>
      </div>
    </section>

    <footer style="margin-top:34px;color:var(--muted);font-size:13px;text-align:center">
      <div style="max-width:900px;margin:0 auto">Diseño coherente con <strong>Mines — Mini Juegos</strong>. Reemplazá <code>MATEOIMG1..4</code> por tus rutas de imagen reales y <code>MATEO1..4</code> por los archivos de juego.</div>
    </footer>
  </div>

  <!-- modal -->
  <div class="modal" id="modal">
    <div class="modal-card" role="dialog" aria-modal="true">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <strong id="modalTitle">Detalle</strong>
        <button id="closeModal" class="btn secondary">Cerrar</button>
      </div>
      <div class="modal-body" id="modalBody" style="margin-top:12px"></div>
    </div>
  </div>






<script>
(function(){
  const STORAGE_KEY = 'casino_balance_ARS';
  const DEFAULT_BAL = 1000;
  const ADMIN_PATH = './admin.json';
  const POLL_INTERVAL_MS = 5000; // poll admin.json every 5 seconds for changes

  // Helpers
  function toNumber(v){
    if (v === null || v === undefined) return 0;
    v = String(v).replace(/[^\d\.,-]/g,'').trim();
    v = v.replace(/\.(?=.*\.)/g,'').replace(/,(?=.*\,)/g,'');
    v = v.replace(',', '.');
    const n = parseFloat(v);
    return isNaN(n)?0:n;
  }
  function formatARS(n){
    if (Math.abs(Math.round(n) - n) < 1e-9) return Math.round(n).toLocaleString('es-AR');
    return n.toLocaleString('es-AR', {minimumFractionDigits:2, maximumFractionDigits:2});
  }

  function readStoredBalance(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if(raw !== null) return Number(raw);
    }catch(e){}
    return null;
  }
  function writeStoredBalance(v){
    try{
      localStorage.setItem(STORAGE_KEY, String(Number(v)||0));
      updateAllDisplays();
    }catch(e){}
  }

  // Fetch admin.json and apply if different
  let lastAdminRaw = null;
  function fetchAndApplyAdmin(){
    return fetch(ADMIN_PATH, {cache:'no-store'}).then(r=>{
      if(!r.ok) throw new Error('no admin');
      return r.text();
    }).then(txt=>{
      if(txt === lastAdminRaw) return null; // no change
      lastAdminRaw = txt;
      try{
        const cfg = JSON.parse(txt);
        const b = (cfg && typeof cfg.balance_ARS !== 'undefined')? Number(cfg.balance_ARS) : DEFAULT_BAL;
        writeStoredBalance(b);
        return b;
      }catch(e){
        // invalid JSON
        return null;
      }
    }).catch(err=>{
      if(readStoredBalance() === null) writeStoredBalance(DEFAULT_BAL);
      return null;
    });
  }

  // Text node sanitizer similar to before
  function sanitizeTextNode(node){
    if(!node || !node.nodeValue) return;
    let txt = node.nodeValue;
    if(/BTC/i.test(txt) || /([0-9\.,]+)\s*(BTC|btc)/i.test(txt)){
      const bal = readStoredBalance() ?? DEFAULT_BAL;
      txt = txt.replace(/([0-9\.,]+)\s*(BTC|btc)/ig, function(_,num){ return formatARS(bal) + ' ARS'; });
      txt = txt.replace(/BTC/ig, 'ARS');
      node.nodeValue = txt;
    }
  }

  function updateAllDisplays(){
    const bal = Number(localStorage.getItem(STORAGE_KEY)) || 0;
    const selectors = [
      '#balance', '#saldo', '#balanceLabel', '.balance', '.saldo', '.user-balance', '.balance-value'
    ];
    selectors.forEach(sel=>{
      document.querySelectorAll(sel).forEach(el=>{
        if(el.tagName === 'INPUT' || el.tagName === 'TEXTAREA'){
          el.value = formatARS(bal);
        } else {
          el.textContent = formatARS(bal) + ' ARS';
        }
      });
    });
    walkTextNodes(document.body, sanitizeTextNode);
  }

  function walkTextNodes(node, fn){
    const walker = document.createTreeWalker(node, NodeFilter.SHOW_TEXT, null, false);
    let n;
    while(n = walker.nextNode()){
      fn(n);
    }
  }

  const observer = new MutationObserver(function(muts){
    muts.forEach(m=>{
      m.addedNodes.forEach(node=>{
        if(node.nodeType === Node.TEXT_NODE){
          sanitizeTextNode(node);
        } else if(node.nodeType === Node.ELEMENT_NODE){
          walkTextNodes(node, sanitizeTextNode);
        }
      });
    });
  });
  observer.observe(document.documentElement || document.body, {childList:true, subtree:true});

  function sanitizeBetInputs(){
    const inputs = Array.from(document.querySelectorAll('input[type="text"], input[type="number"], input:not([type])'));
    inputs.forEach(inp=>{
      const idn = (inp.id||'') + ' ' + (inp.name||'') + ' ' + (inp.className||'');
      if(/bet|wager|amount|apuesta|monto|stake|cantidad/i.test(idn)){
        inp.setAttribute('placeholder', 'Monto en ARS');
        inp.addEventListener('input', function(e){
          const v = inp.value || '';
          const num = toNumber(v);
          inp.value = formatARS(num);
        });
      }
    });

    const buttons = Array.from(document.querySelectorAll('button, a'));
    buttons.forEach(btn=>{
      const txt = (btn.textContent||'') + ' ' + (btn.id||'') + ' ' + (btn.className||'');
      if(/bet|apostar|apost|spin|jugar|play|stake/i.test(txt)){
        btn.addEventListener('click', function(e){
          let betInput = null;
          const parent = btn.closest('form, div, section, article') || document;
          const candidates = parent.querySelectorAll('input, textarea, [contenteditable="true"]');
          candidates.forEach(c=>{
            const idn = (c.id||'') + ' ' + (c.name||'') + ' ' + (c.className||'');
            if(/bet|wager|amount|apuesta|monto|stake|cantidad/i.test(idn) && !betInput) betInput = c;
          });
          if(!betInput){
            Array.from(parent.querySelectorAll('input')).forEach(c=>{
              if((c.type==='number' || c.type==='text') && !betInput) betInput = c;
            });
          }
          if(betInput){
            const num = toNumber(betInput.value || betInput.textContent || '');
            const final = (num <= 0) ? 1 : num;
            if(betInput.tagName === 'INPUT' || betInput.tagName === 'TEXTAREA'){
              betInput.value = formatARS(final);
            } else {
              betInput.textContent = formatARS(final);
            }
          }
          walkTextNodes(parent, sanitizeTextNode);
        }, {capture:true});
      }
    });
  }

  window.CasinoBalance = {
    get: function(){ return Number(localStorage.getItem(STORAGE_KEY)) || 0; },
    set: function(v){ writeStoredBalance(Number(v)||0); },
    add: function(v){ const cur = Number(localStorage.getItem(STORAGE_KEY))||0; writeStoredBalance(cur + Number(v||0)); },
    sub: function(v){ const cur = Number(localStorage.getItem(STORAGE_KEY))||0; writeStoredBalance(cur - Number(v||0)); },
    reloadFromAdmin: function(){ return fetchAndApplyAdmin(); }
  };

  // Initialize: fetch admin.json immediately, then poll
  fetchAndApplyAdmin().then(function(){
    updateAllDisplays();
    sanitizeBetInputs();
    setInterval(function(){
      fetchAndApplyAdmin().then(function(changed){
        if(changed !== null){
          console.info('admin.json updated, balance set to', changed);
        }
      });
      updateAllDisplays();
      sanitizeBetInputs();
    }, POLL_INTERVAL_MS);
  });
})();
</script>

</body>
</html>
